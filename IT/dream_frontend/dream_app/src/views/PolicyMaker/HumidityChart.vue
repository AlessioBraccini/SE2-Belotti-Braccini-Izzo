<template>
  <div class="container">
    <div class="inner">
      <canvas id="humidityChart"></canvas>
    </div>
  </div>
</template>

<script>
import Chart from 'chart.js/auto'
import axios from "axios";

export default {
  name: 'HumidityChart',

  async mounted() {

    let hum, temp

    const getHumidity = async () => {
      await axios.get('http://localhost:8000/api/v1/humidity').then(resp => {
        hum = resp.data.humidity
      })
      return hum
    }
    const getTemp = async () => {
      await axios.get('http://localhost:8000/api/v1/humidity').then(resp => {
        temp = resp.data.temperature
      })
      return temp
    }


    const ctx = document.getElementById('humidityChart');
    new Chart(ctx,{
      type: "bar",
      data: {
        labels: [
          'Adilabad',
          'Bhadradri Kothagudem',
          'Hanumakonda',
          'Hyderabad',
          'Jagtial',
          'Jangaon',
          'Jayashankar Bhupalpally',
          'Jogulamba Gadwal',
          'Kamareddy',
          'Karimnagar',
          'Khammam',
          'Kumuram Bheem',
          'Mahabubabad',
          'Mahabubnagar',
          'Mancherial',
          'Medak',
          'Medchal-Malkajgiri',
          'Mulugu',
          'Nagarkurnool',
          'Nalgonda',
          'Narayanpet',
          'Nirmal',
          'Nizamabad',
          'Peddapalli',
          'Rajanna Sircilla',
          'Rangareddy',
          'Sangareddy',
          'Siddipet',
          'Suryapet',
          'Vikarabad',
          'Wanaparthy',
          'Warangal',
          'Yadadri Bhuvanagiri'],
        datasets: [
          {   type: 'bar',
            label: "Humidity",
            data: await getHumidity(),
            backgroundColor: "rgba(54,73,93,.5)",
            borderColor: "#36495d",
            borderWidth: 3
          },
          {
            type: 'line',
            label: "Temperature",
            data: await getTemp(),
            backgroundColor: "red",
            borderColor: "red",
            borderWidth: 3,
          }
        ]
      },
      options: {
        responsive: true,
        lineTension: 0,
        layout: {
          padding: 20
        },
        scales: {
          y:{
            type: 'linear',
            position: 'left',
            min: 0,
            max: 100
          },

          y1: {
            type: 'linear',
            position: 'right',
            max: 60,
            min: 0,
            grid: {
              drawOnChartArea: false,
            },
          }
        },
      },
    });
  }
}
</script>

<style scoped>
  .container{
    position:relative;
    width: 90%;
    overflow: scroll;
    left: 5%;
    background-color: white;
    border-radius: 22px;
    margin-top: 20px;
  }
  .inner{
    width: 855px;
    margin-bottom:20px;
  }

  @media only screen and (min-width: 995px) and (max-width: 1200px) {
    .container{
      overflow: hidden;
    }
  }

  @media only screen and (min-width: 1200px) and (max-width: 1700px) {
    .container{
      overflow: hidden;
    }
    .inner{
      margin-left: 18%;
    }
  }
</style>